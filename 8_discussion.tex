%\section{Discussion}


\subsection{Comparison of beading schemes}
We can see from \cref{TEST_naive_accuracy}(top) and~\ref{over_underfill} that the uniform technique causes a lot of overfills and underfills: on average approximately \SI{1}{\percent} of the total target area is covered by underfill and likewise for overfill.
These defects are supposed to negatively influence the mechanical properties of the parts, and exceed the point that process parameters can be reliably correlated to mechanical properties of the part. 
To our knowledge, the uniform beading scheme, as well as the outer beading scheme, is of little use to FDM printers.

The constant bead count scheme effectively deals with underfills, but generates orders of magnitude more overfills compared to the other schemes. 
Also, the scheme comes at the cost of greatly varying bead widths and an average bead width that is not close to the nominal bead width.
Note that most overfill areas occur near regions of alternating bead width. 
For an input outline shape which contains both very small and very large features, the the constant bead count scheme produces bead widths which can fall outside of the range of manufacturable bead widths.
Moreover the centrality marking is not robust against small perturbations in the outline; adding a small chamfer in a corner causes the unmarked ST to be very small at that location, which results in tiny bead widths.

In \cref{TEST_Center_accuracy} we can see that
the centered beading scheme effectively deals with both overfill and underfill and produces desired bead widths in all locations, except for the extrusion paths in the center, where the bead widths are within a factor 2 off from the desired bead width.
According to \cref{over_underfill} the overfill and underfill for the centered, the evenly distributed and the inward distributed scheme are all approximately \SI{0.2}{\percent}, which is a considerable improvement over the uniform technique.

However, according to \cref{widthHistogram} the centered scheme exhibits a wider range of bead widths than the distributed schemes:
the standard deviation of the bead widths in the centered scheme is approximately \SI{39}{\micro\meter}, while that of the distributed schemes is approximately \SI{14}{\micro\meter}.
We can therefore state that the distributed schemes result in bead widths closer to the nominal widths compared to the centered scheme.
This is desirable for the manufacturability of the beads and can therefore have a positive effect on the mechanical properties and surface quality of the 3D prints. 

The inward distributed scheme is introduced with the intention to limit the number of beads deviating from the nominal bead width and to limit the number of angled extrusion segments in transitioning regions.
This expected effect is difficult to be confirmed when comparing \cref{TEST_Distributed_accuracy} with~\ref{TEST_InwardDistributed_accuracy}, because there are no large solid areas in that specific shape.

However, when comparing the bead width of the outer toolpaths, \cref{distributed_comparison} and  \cref{widthIndexedHistogram}, we can clearly see that the these toolpaths have the nominal bead width more often, which means that errors from inaccuracies due to deviation from the nominal bead width are concentrated near the center of the shape, leaving the dimensional accuracy of the outline shape less affected, if at all. 
Furthermore, we find that compared to evenly distributed, the inward distributed scheme produces smoother toolpaths overall (\cref{smoothness}), and with less jaggedness on the contour toolpaths (\cref{smoothness}). 
Therefore, when using the inward distributed scheme the surface of the 3D print is less affected by both width variation and jagged toolpaths, while overfill and underfill are kept at a low percentage.


\subsection{Theoretical analysis}
\jun{I suggest to dissolve this subsection. see comments and suggested changes below.}

In this paper the significance measure is not used heuristically, as it is sometimes used in other literature.
The significance measure is an exact measure of the relative size of gaps when using the uniform toolpathing method.
See \cref{naive_overfill_underfill}
\jun{this is in the method, and thus can be removed.}
Note also that contrary to some literature we do not remove edges from the skeleton, but leave it intact.
The final skeleton is still an exact and full feature descriptor.
In that sense our framework provides an exact solution space.
\jun{what is a solution space? what is the benefit of using an exact and full feature descriptor regarding toolpath accuracy, uniformity and smoothness?}

Note also that our method is robust against small perturbations in the input shape.
Geometrically small changes to the outline shape introduce extra edges and therefore change the topology of the graph of the ST.
However, the significance measure and beading are defined in terms of radial distances so the robustness of the distance field against such perturbations means our method bypasses the instability of the skeleton. \jun{this could be mentioned somewhere in the method, shortly. The uniform approach can also be thought of using the distance field, is it less robust than ours?}
Moreover, we have developed a method for dealing with edges within transition regions such that the toolpath is the same as if there was no such edge in that region.
The toolpaths generated using our framework therefore remain the same when extra edges are added to the ST.
\jun{this could be integrated in paragraph Smooth transitions to motivate the fractional bead count}

Our framework is also local.
The toolpathing around some section of the input polygons is independent of far away regions of the polygon.
This means the toolpathing is stable against large perturbations of the input shape in far away regions
and it also allows for some parallelism during the computation of the toolpaths.
\jun{This could mentioned in paragraph Computational performance. This potentially could be parallelized for speeding up.}













\input{10_applications}









\subsection{Limitations}
\jun{postpone this subsection to Applications}
We note that printing with varying width is not the current standard in FDM printing.
It calls for adaptations and developments in printers and the workflow.
In the beading schemes we set a transition length of $t(n) = w^*$.
That might demand \jun{can we say, "while it rarely happens, it may demand ..."} changes in cross-sectional area of the bead up to \SI{200}{\percent} over a small distance that is comparable to the nozzle size.
This is challenging for some hardware.
The effect of varying the movement speed to change the cross-sectional area is limited, since the movement speed is constrained by acceleration considerations around sites in the toolpath.
Our schemes require a more accurate control of the volumetric flow rate (in \si{\milli\meter\cubed\per\second}).
Using a filament feeder directly mounted on the print head (a.k.a. direct drive) is certainly a large improvement \jun{in terms of what? can we say, "... shall improve ... significantly"} over Bowden style FDM printers,
but still requires some control system in order to accurately change the volumetric flow rate such as pressure advance algorithms~\cite{tronvoll2019investigating}.
Yet inaccuracies in direct drive systems employing advance algorithms might arise due to the changes in back-pressure required by changing bead size.
We expect the development in printing hardware will address these challenges in the future.


Another limiting factor in the adoption of adaptive bead width is G-code which stores machine instructions. G-code does not support moves with varying cross-sectional area.
A typical extrusion move \lstinline{G1 X$x$ Y$y$ E$v$} only specifies the total amount of volume $v$ to be extruded in the move, not how that total amount should be distributed across \jun{along?} the extrusion move.
A workaround is to approximate a variable width extrusion segment by smaller segments with constant width. This, nevertheless, introduces errors.
Ideally the G-code language would be expanded in some way to allow for extrusion segments with varying cross-sectional area.


% Taking a broader perspective, we note that our proposed inward distributed scheme is a pragmatic solution.
% Rather than deriving some optimal beading scheme from a clear specification of the objective, we propose some arbitrary inward distributed beading scheme and show that it is better than the other beading schemes.
% An optimal beading scheme can be derived if the objective is formalized terms of a unambiguous fitness function, but that would depend on the specific hardware setup and application for which toolpaths are generated.
% This manuscript is therefore limited to showing the flexibility and versatility of the framework, rather than deriving an optimal beading scheme.




